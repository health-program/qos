<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.paladin.qos.mapper.data.DataUnitMapper">

    <select id="getBedReportByQuery" resultType="com.paladin.qos.service.data.vo.BedReportVO" >
        SELECT
        u.name as unitName,
        u.bed_number as bedNumber,
        sum(i.P_O_BED) as openBedNumber,
        SUM(i.P_OC_BED) as userBedNumber
        FROM
        data_unit AS u
        LEFT JOIN in_workload AS i ON ORGAN_CODE = u.id
        WHERE 1=1
        <if test="unitId != null and unitId !='' ">
        and u.id =#{unitId}
        </if>
        <if test="month != null and month !='' and year !=null and year !=''">
        and i.REP_TYPE = #{month}
        and i.REP_YEAR = #{year}
        </if>
        GROUP BY
        u.id
    </select>
    
    <select id="selectData" resultType="com.paladin.qos.service.data.vo.DataUnitVO">
    SELECT d.id,d.`name` from data_unit as d where 1=1
    <if test="array !=null and array !='' ">
     and d.id in
     <foreach collection="array" index="index" item="item"
            open="(" separator="," close=")">
            #{item}
        </foreach>
    </if>
    </select>

</mapper>
