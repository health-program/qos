<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:include="/qos/header" />
<link rel="stylesheet" href="/static/css/SearchInfoWindow_min.css">
<link rel="stylesheet" href="/static/css/index.css">
<link rel="stylesheet" href="/static/css/quality.css">
<script type="text/javascript" src="/static/assets/echarts/echarts.min.js"></script>
<script type="text/javascript" src="/static/assets/map/eventwrapper.min.js"></script>
<script type="text/javascript" src="/static/assets/map/mapapi.js"></script>
<script type="text/javascript" src="/static/assets/map/mapgetscript.js"></script>
<script type="text/javascript" src="/static/assets/map/SearchInfoWindow_min.js"></script>


<body id="body">
    <nav id="nav">
        <span class='index_left text-00e4ff left'>
             全区域医疗服务质量展示
        </span>
        <div class="middle">
         <!--   <span class="text-00e4ff">昆山市医疗服务综合质量展示&nbsp;&nbsp;&nbsp;&nbsp;/</span>
            <span class="text-00B4FF">&nbsp;&nbsp;&nbsp;&nbsp;昆山市社区卫生服务综合质量展示&nbsp;&nbsp;&nbsp;&nbsp;/</span>
            <span class="text-00B4FF">&nbsp;&nbsp;&nbsp;&nbsp;昆山市学校及疫情数据质量展示</span>-->
        </div>
        <!--<div class='right'>
            <span class="text-00B4FF"><i class="circle">•</i>社区医疗&nbsp;&nbsp;&nbsp;&nbsp;</span>
            <span class="text-00B4FF"><i class="circle">•</i>基本公共卫生&nbsp;&nbsp;&nbsp;&nbsp;</span>
            <span class="text-00B4FF"><i class="circle">•</i>家庭医生</span>
        </div>-->
    </nav>
        <div id="quailty_middle">
            <div id="quailty_middle_left">
                <div class="quailty_middle_hospitel">
                    <div class="quailty_bottom_header1">
                        医院就诊top5
                    </div>
                    <div id="middle_hospitel">

                    </div>
                </div>
                <div class="quailty_middle_social">
                    <div class="quailty_bottom_header1">
                        社区就诊top5
                    </div>
                    <div id="medicalAdvice">

                    </div>
                </div>
            </div>
            <div id="quailty_middle_map"></div>
            <div id="quailty_middle_right">
                <div class="quailty_right_pay">
                    <div class="quailty_bottom_header2">
                        支付方式对比
                        <select id="selectID">
                            <option value="31009">
                                医院
                            </option>
                            <option value="31010">
                                社区
                            </option>
                        </select>
                    </div>

                    <div id="paycomparsion">

                    </div>
                </div>
                <div class="quailty_right_income">
                    <div class="quailty_bottom_header2">
                        收入分类
                        <!--<select id="incomeSelect">
                            <option value="15005">
                                医保
                            </option>
                            <option value="15006">
                               自费
                            </option>
                        </select>-->

                        <select id="incomeSelect">
                            <option value="31009">
                                医院
                            </option>
                            <option value="31010">
                                社区
                            </option>
                        </select>


                    </div>
                    <div id="incomeKind">

                    </div>
                </div>
                <div class="quailty_right_antibacterial">
                    <div class="quailty_bottom_header2">
                        抗菌药物使用top5
                    </div>
                    <div id="antibacterial"></div>
                </div>
            </div>
        </div>
        <div id="quailty_bottom">
            <div class="quailty_bottom_left">
                <div class="quailty_bottom_header">
                    就诊人次时间走势
                </div>
                <div id="medicaladvice">

                </div>
            </div>
            <div class="quailty_bottom_right">
                <div class="quailty_bottom_header">
                    患者列表
                </div>
                <div>
                    <div class="header_bg quailty_bottom_right_header">
                        <span class="quailty_serial">序号</span>
                        <span class="quailty_seek">就诊机构</span>
                        <span class="quailty_department">就诊科室</span>
                        <span class="quailty_name">患者姓名</span>
                        <span class="quailty_sex">患者性别</span>
                        <span class="quailty_date">就诊日期</span>
                        <span class="quailty_sick">结算类别</span>
                     </div>
                    <div id="box" class="quailty_bottom_right_box">
                        <ul id="list1" >
	                          <li>
	                            <span class="quailty_serial">序号</span>
		                        <span class="quailty_seek">就诊机构</span>
		                        <span class="quailty_department">就诊科室</span>
		                        <span class="quailty_name">患者姓名</span>
		                        <span class="quailty_sex">患者性别</span>
		                        <span class="quailty_date">就诊日期</span>
		                        <span class="quailty_sick">结算类别</span>
	                         </li>
                        </ul>
                        <ul id="list2">
                          
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<div th:include="/qos/footer" />
<script type="text/javascript" src="/static/js/quailtydisplay/common.js"></script><!--旭武封装的方法的month等-->
<script type="text/javascript" src="/static/js/quailtydisplay/communityVist.js"></script><!--社区就诊top5-->
<script type="text/javascript" src="/static/js/quailtydisplay/hospitalVist.js"></script><!--医院就诊top5-->
<script type="text/javascript" src="/static/js/quailtydisplay/medicalVist.js"></script><!--就诊人次时间走势-->
<script type="text/javascript" src="/static/js/quailtydisplay/paymethods.js"></script><!--支付方式对比-->
<script type="text/javascript" src="/static/js/quailtydisplay/incomeKind.js"></script><!--收入分类对比-->
<script type="text/javascript" src="/static/js/quailtydisplay/antibacterial.js"></script><!--抗菌药物使用top5-->
<script type="text/javascript" src="/static/js/quailtydisplay/patientList.js"></script><!--患者列表-->
<script>
$(function() {
        alert(534)
	$.ajax({
		type : "post",    //请求类型
        url : "/home/page/qos/quailtydisplay/getRegisterList",
        anysc:false,
        success: function (rawData){
        	console.log(rawData);
        	rawData.result.forEach(function(val,index){
        		
        	});
        	 
        }
	})
	

	//无缝滚动开始
	var box = document.getElementById("box");
    var l1 = document.getElementById("list1");
    var l2 = document.getElementById("list2");
    l2.innerHTML = l1.innerHTML; //克隆list1的数据，使得list2和list1的数据一样
    function scrollup() {
        if (box.scrollTop >= l1.offsetHeight) { //滚动条距离顶部的值恰好等于list1的高度时，达到滚动临界点，此时将让scrollTop=0,让list1回到初始位置，实现无缝滚动
            box.scrollTop = 0;
        } else {
            box.scrollTop++;
        }
    }

    var scrollMove = setInterval(scrollup, 30); //数值越大，滚动速度越慢

    //鼠标经过时，滚动停止
    box.onmouseover = function() {
        clearInterval(scrollMove)
    }

    //鼠标离开时，滚动继续
    box.onmouseout = function() {
        scrollMove = setInterval(scrollup, 30);
    }
	//无缝滚动结束




})
</script>


<script>


  $.ajax({
        type : "post",    //请求类型
        url : "/qos/address/search/all",//请求的 URL地址
        success: function (rawData) {
                 markerArr=rawData.result;
              //开始
                   var strs = "";
              // 百度地图API功能
              var map = new BMap.Map("quailty_middle_map");    // 创建Map实例
              var cityName = '昆山';
              map.centerAndZoom(cityName, 12);
              map.addControl(new BMap.MapTypeControl());   //添加地图类型控件
              map.setCurrentCity("昆山");          // 设置地图显示的城市 此项是必须设置的
              map.enableScrollWheelZoom(true);
          //  map.enableContinuousZoom(false);    //启用地图惯性拖拽，默认禁用
              map.addControl(new BMap.NavigationControl());
              map.addControl(new BMap.ScaleControl());
              map.addControl(new BMap.OverviewMapControl());


              function getBoundary1()
              {
                  var bdary = new BMap.Boundary();
                  var name = '昆山';//在这里直接输入城市名字即可
                  bdary.get(name, function(rs){ //获取行政区域
                      map.clearOverlays(); //清除地图覆盖物
                      var count = rs.boundaries.length; //行政区域的点有多少个
                      for(var i = 0; i < count; i++){
                          var EN_JW = "180, 90;";         //东北角
                          var NW_JW = "-180,  90;";       //西北角
                          var WS_JW = "-180, -90;";       //西南角
                          var SE_JW = "180, -90;";        //东南角
                          // 之前的 var ply = new BMap.Polygon(rs.boundaries[i], { strokeWeight: 2, strokeColor: "#37dfee", fillColor: "#f0f0f0", fillOpacity:0.5, strokeOpacity: 0.7 }); //建立多边形覆盖物
                          //4.添加环形遮罩层
                          var ply1 = new BMap.Polygon(rs.boundaries[0] + SE_JW + SE_JW + WS_JW + NW_JW + EN_JW + SE_JW, { strokeColor: "none", fillColor: "#081327", fillOpacity:1, strokeOpacity: 0.5 }); //建立多边形覆盖物
                          map.addOverlay(ply1);
                          //5. 给目标行政区划添加边框，其实就是给目标行政区划添加一个没有填充物的遮罩层
                          var ply = new BMap.Polygon(rs.boundaries[0], { strokeWeight: 2, strokeColor: "#37dfee",fillColor: "" });
                          map.addOverlay(ply);
                          map.addOverlay(ply); //添加覆盖物
                          map.setViewport(ply.getPath()); //调整视野
                      }
                      addlabel();
                      });
              }
              getBoundary1();
              var mapStyle = {style: "midnight"}
              map.setMapStyle(mapStyle);
              function addlabel() {
                  var point = new Array(); //存放标注点经纬信息的数组
                  var marker = new Array(); //存放标注点对象的数组
                  var info = new Array(); //存放提示信息窗口对象的数组
                  var searchInfoWindow = new Array();//存放检索信息窗口对象的数组
                  var myIcon = new BMap.Icon("../../../static/image/index/map_indexred.png", new BMap.Size(20, 25));

                  for (var i = 0; i < markerArr.length; i++) {
                      var p0 = markerArr[i].orgLon; //orgLon
                      var p1 = markerArr[i].orgLat; //按照原数组的point格式将地图点坐标的经纬度分别提出来
                      point[i] = new window.BMap.Point(p0, p1); //循环生成新的地图点
                      marker[i] = new window.BMap.Marker(point[i], {icon: myIcon});
                      map.addOverlay(marker[i]);
                       marker[i].setAnimation(BMAP_ANIMATION_BOUNCE); //跳动的动画
                            function trues(data){
                            if(data==true){
                                return '是'
                            }else{
                                return '否'
                            }
                      }

                      // 创建信息窗口对象
                          info[i] = "<p style=’font-size:12px;line-height:1.6em;’>"
                              + "</br><b class='text-0efcff'>名称：</b>"
                              + markerArr[i].orgName
                              + "</br><b class='text-0efcff'>机构编码：</b>"
                              + markerArr[i].orgType
                              + "</br><b class='text-0efcff'>当月门诊次数：</b>"
                              + markerArr[i].patients
                              + "</br><b class='text-0efcff'>当月住院人次：</b>"
                              + markerArr[i].hospital
                              + "</br><b class='text-0efcff'>地址：</b>"
                              + markerArr[i].orgAddress
                              + "</br></p>";


                    //创建百度样式检索信息窗口对象
                      searchInfoWindow[i] = new BMapLib.SearchInfoWindow(map,info[i], {
                          title: markerArr[i].unitName, //标题
                          width: 290, //宽度
                          height: 100, //高度
                          marginLeft: 100,
                          panel: "panel",
                          enableSendToPhone: false,
                          searchTypes: []

                      });


                      //添加点击事件
                   marker[i].addEventListener("click", (function (k) {
                            return function () {
                              searchInfoWindow[k].open(marker[k]);
                            }
                      })(i));
        }
    //结束

   }

            //结束
          }
       });



</script>

</html>